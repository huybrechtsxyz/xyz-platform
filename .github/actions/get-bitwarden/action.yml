name: Get Bitwarden
description: Installs Bitwarden CLI and authenticates using BITWARDEN_TOKEN

inputs:
  bitwarden_token:
    description: Bitwarden session token
    required: true

runs:
  using: "composite"
  steps:
    - name: Install Bitwarden Secrets Manager CLI
      shell: bash
      run: |
        curl -LO "https://github.com/bitwarden/sdk-sm/releases/download/bws-v1.0.0/bws-x86_64-unknown-linux-gnu-1.0.0.zip"
        unzip bws-x86_64-unknown-linux-gnu-1.0.0.zip
        sudo mv bws /usr/local/bin/
        bws --version  # should output: 1.0.0

    - name: Authenticate with Bitwarden Secrets Manager
      shell: bash
      run: |
        export BWS_ACCESS_TOKEN=${{ inputs.bitwarden_token }}
